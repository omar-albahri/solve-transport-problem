$title A Transportation Problem (TRNSPORT,SEQ=1)


Set
   i 'hospital' / 1*10 /
   j 'local'    / 1*53 /;

Parameter
   a(i) 'capacity of hospital i in cases'
        /1        820
        2        445
        3        204
        4        651
        5        525
        6        398
        7        999
        8        150
        9        100
        10        86/;
Parameter
   b(j) 'demand at people j'
        /1        93970
        2        47289
        3        20511
        4        28125
        5        19011
        6        15787
        7        15701
        8        47064
        9        41646
        10        57407
        11        1522
        12        0
        13        59995
        14        42085
        15        31706
        16        31630
        17        11525
        18        45340
        19        62126
        20        24948
        21        74860
        22        59279
        23        21225
        24        42813
        25        116475
        26        22058
        27        15433
        28        25415
        29        60764
        30        3617
        31        4160
        32        124
        33        29301
        34        1699
        35        29869
        36        41970
        37        41268
        38        10403
        39        6948
        40        17659
        41        6247
        42        12566
        43        8161
        44        43994
        45        102530
        46        23173
        47        39886
        48        24750
        49        52050
        50        52055
        51        84121
        52        48237
        53        28742/;
          

Table d(i,j) 'distance in meters'
    1           2           3           4           5           6           7           8           9           10          11          12          13          14          15          16          17          18          19          20          21          22          23          24          25          26          27          28          29          30          31          32          33          34          35          36          37          38          39          40          41          42          43          44          45          46          47          48          49          50          51          52          53
1   206.9857382 173.366921  286.3858476 156.4811545 148.9114442 183.6281323 129.4508811 148.2111779 231.0836388 195.2665953 263.622075  269.613872  123.1777998 85.02686803 122.3507094 135.1846379 236.1621897 77.28006707 24.17150798 68.6060119  75.13443464 176.8477579 214.8882482 259.7823866 204.9028132 269.613872  365.1794928 394.6036052 292.1500282 296.8775774 353.9835454 204.6646702 208.9709938 224.6827228 221.3185159 184.3662291 169.6973525 131.0724928 168.4550863 155.1635159 169.0199804 151.4526237 133.3072411 204.5147522 194.7190669 215.2851016 175.6186095 151.1855168 158.6635769 75.78869982 162.3026952 99.8088656  182.6800332
2   210.8495922 179.4471322 291.3979992 162.059681  154.7156342 187.918601  134.6860548 152.3008215 233.2510421 196.1367947 265.3498285 272.073612  129.154546  90.79241208 127.8499385 132.064362  232.2693994 72.21195844 21.68529554 73.81590361 78.18256682 180.1474662 217.5573041 263.0998533 208.4720475 272.073612  368.934666  397.8130697 296.4068729 302.1337664 358.3215413 210.41683   214.9291619 226.7585449 217.9320154 181.53473   166.7479675 137.1284924 174.5577195 160.9807741 175.1578253 157.5588535 139.2352688 208.429573  198.4581039 220.6692053 181.5942321 156.8133832 164.6788802 79.18663234 161.8267151 98.53936333 179.8551409
3   154.813256  88.5705501  213.4236325 78.1277026  66.88345449 126.3079932 87.02409342 126.8651283 231.3647978 189.0154861 239.9629373 235.0184218 38.96805242 16.59371978 48.59034301 184.6683305 288.4784582 151.0651033 96.25382195 58.06005878 94.16815882 136.6823549 180.7160406 212.9405245 157.6054775 235.0184218 334.2085769 371.8832397 254.7669694 239.3930822 313.0805785 138.2363814 135.6611487 198.5494487 286.6024548 245.7802919 232.809922  46.22002979 83.87025512 72.78940045 85.95282375 66.96293789 49.6470891  178.8804004 173.1929671 158.2060101 103.0576781 93.19127827 85.39735386 66.77570481 177.7450947 135.5246375 244.1049146
4   156.7582831 142.9824432 239.17915   115.0066521 111.2214947 133.9556031 135.6860387 166.9232508 262.5248279 153.1245369 217.1791459 220.9160129 90.94390882 50.99008131 80.79690822 125.093067  229.2245145 94.37142269 46.41365694 83.07145907 107.2803136 126.770406  165.8105798 209.645812  154.6361368 220.9160129 382.6077468 416.6833316 305.3304023 297.075317  365.5290071 197.4511365 195.8582573 177.2144586 271.5770444 234.2881004 219.7351441 101.3581788 139.5665906 117.5400173 144.223564  123.5064524 99.06555158 222.8799045 214.9804151 215.0819594 163.0773063 149.0479692 145.3881253 25.93434887 129.0718782 77.45370547 232.5969299
5   589.5932511 447.1500559 556.3712783 498.4912775 484.3196921 563.984495  407.1503576 385.8806891 341.7801554 667.8626811 696.8509679 677.0106409 477.8496565 502.4471196 506.1186699 664.8593374 768.3303433 609.2960824 556.5033705 465.8732308 462.5619908 595.6251372 635.3728985 638.0648671 599.8158423 677.0106409 181.5971676 183.9031215 241.8172287 251.1547785 179.6533755 353.8086507 366.1585686 659.3030368 542.185763  515.7873061 518.6579228 466.9352757 444.2138247 482.0976554 430.3805646 450.403679  478.5870107 331.3702364 342.6312431 329.3278191 391.5051307 394.131816  407.2798508 553.9170481 664.5814181 619.5679869 515.4570296
6   87.46355125 91.60785089 159.6048605 44.89495533 51.62778821 59.75852741 149.3606571 192.0594435 297.8746736 135.7328609 175.9107574 168.2425139 55.29620378 53.46151442 26.44303453 173.3983965 270.0427864 167.9438209 125.9972368 124.7508368 159.815741  70.73145764 114.9480437 145.3756379 89.99699853 168.2425139 390.1323154 430.7840246 309.3786936 281.0298528 364.2077294 178.4012719 167.2016705 134.8315687 345.0012738 305.6578437 291.8242648 65.48122999 91.98539797 56.22897875 103.6845818 82.32506105 53.55630209 240.8794467 236.5821319 205.1595697 140.7310462 146.8732138 125.728836  61.03635653 140.5356727 123.5886831 303.9621791
7   502.4239283 358.2604133 492.3793998 406.3492429 390.2888743 474.2986208 292.0126033 262.0951469 201.7885992 565.5759826 605.8302535 591.2279808 377.1295551 394.0159358 405.9702288 544.5562389 645.9097824 483.4238527 433.9032058 345.8718866 336.0641395 500.8981923 543.6154506 556.4860838 510.8851026 591.2279808 44.71583306 46.80290228 123.2086018 170.6618164 73.38302448 259.388484  278.205869  565.8292066 399.5491301 374.0590645 377.6027049 367.5287672 353.6524191 389.6053041 338.6573555 355.3278623 380.4633059 205.5148787 215.1923285 228.9712992 295.0474454 286.3202522 307.7420684 442.5660146 554.3196903 502.8306731 373.7966469
8   377.9216817 240.2605508 390.4725892 281.5707715 264.5950457 348.6134699 151.6548748 116.0290595 71.70830806 427.6157676 475.3682913 465.268067  245.7191562 255.2444187 273.7278157 397.4961831 498.166774  335.3915976 286.5729021 200.3419361 188.1690673 369.9769188 413.9630053 435.074006  384.5496158 465.268067  103.477749  133.9152933 50.47051589 119.084022  104.7621982 148.1526507 171.9146398 434.2921791 276.5917097 243.7566151 243.9529562 237.91257   234.2403763 265.4807443 219.3592278 230.9395416 251.347046  60.10558998 68.11337864 116.4291773 175.1623549 153.9437822 182.6984146 300.6005766 411.5689556 357.2750555 243.1146249
9   53.02324933 98.81893911 124.8279437 47.58412804 63.09200641 23.66233572 179.0974256 223.1307464 329.7074506 128.3683393 152.605988  139.3630687 80.91964137 90.08286429 55.61601508 192.8257653 282.5014381 198.4117772 160.9455567 160.8208788 196.4226351 49.97815225 90.39049276 111.455519  58.60708138 139.3630687 412.28925   454.933607  331.3352594 295.3639191 383.2789007 195.0649993 179.9752837 113.5586213 382.493653  343.1852891 329.3456926 88.03300138 101.8192932 64.24525039 116.0965085 98.0551703  74.59759837 268.8224045 265.6606022 224.4491127 158.4280657 172.0081662 145.9358777 93.61530886 146.846891  145.9066675 341.4896414
10  226.9932573 205.7189184 312.3278095 185.8806205 179.5880586 206.0341966 159.4684299 173.3310271 246.6634257 199.5314161 271.9099843 281.7880711 154.9086524 115.7346549 151.4658307 118.6538514 214.2825213 50.72845314 27.40823359 98.8727949  96.92662383 194.1137047 228.5147604 276.5992943 223.3638478 281.7880711 388.0414671 414.7761196 317.5008811 326.7042386 379.6150066 236.5760522 241.610749  235.0863533 207.0469735 173.7462284 158.5871029 163.2879042 200.9808818 185.9009582 201.9090056 184.015186  164.730664  228.5441957 217.989284  245.7298528 208.3200266 182.6752951 191.485704  95.46582206 159.822191  94.78266554 172.1202675
;

Scalar f 'freight in SP per case per meters' / 90 /;

Parameter c(i,j) 'transport cost in meters per case';
c(i,j) = f*d(i,j)/1000;

Variable
   x(i,j) 'shipment quantities in cases'
   z      'total transportation costs in thousands of SP';

Positive Variable x;

Equation
   cost      'define objective function'
   supply(i) 'observe supply limit at plant i'
   demand(j) 'satisfy demand at market j';

cost..      z =e= sum((i,j), c(i,j)*x(i,j));

supply(i).. sum(j, x(i,j)) =l= a(i);

demand(j).. sum(i, x(i,j)) =g= b(j);

Model transport / all /;

solve transport using lp minimizing z;

display x.l, x.m;
